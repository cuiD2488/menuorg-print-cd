<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Restaurant Order Print System</title>
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <div class="container">
      <!-- Login Section -->
      <div id="loginSection" class="section">
        <div class="login-container">
          <h2>User Login</h2>
          <form id="loginForm">
            <div class="form-group">
              <label for="username">Username:</label>
              <input
                type="text"
                id="username"
                required
                placeholder="Enter username"
              />
            </div>
            <div class="form-group">
              <label for="password">Password:</label>
              <input
                type="password"
                id="password"
                required
                placeholder="Enter password"
              />
            </div>
            <div class="form-group">
              <label class="checkbox-label">
                <input type="checkbox" id="rememberLogin" />
                <span class="checkmark"></span>
                Remember username and password
              </label>
            </div>
            <div class="form-group">
              <button type="submit" id="loginBtn">Login</button>
            </div>
            <div class="login-status" id="loginStatus"></div>
          </form>
        </div>
      </div>

      <!-- Main Section -->
      <div id="mainSection" class="section hidden">
        <div class="header">
          <h1>Restaurant Order Print System</h1>
          <div class="user-info">
            <span id="userInfo"></span>
            <button id="logoutBtn" class="btn-secondary">Logout</button>
          </div>
        </div>

        <div class="content">
          <!-- Left Panel -->
          <div class="left-panel">
            <!-- Printer Configuration -->
            <div class="config-panel">
              <h3>打印机设置</h3>
              <div class="printer-config">
                <div class="printer-header">
                  <span>可用打印机:</span>
                  <div class="header-actions">
                    <button id="refreshPrinters" class="btn-small">刷新</button>
                    <button
                      id="selectAllPrinters"
                      class="btn-small btn-secondary"
                    >
                      全选
                    </button>
                    <button
                      id="clearAllPrinters"
                      class="btn-small btn-secondary"
                    >
                      清空
                    </button>
                  </div>
                </div>

                <!-- 打印机列表容器 -->
                <div id="printerList" class="printer-list">
                  <div class="loading-text">正在加载打印机...</div>
                </div>

                <div class="printer-actions">
                  <button id="testPrint" class="btn-small">测试打印</button>
                </div>
              </div>
              <div class="auto-print-config">
                <label class="checkbox-label">
                  <input type="checkbox" id="autoPrint" checked />
                  <span class="checkmark"></span>
                  自动打印新订单
                </label>
              </div>
            </div>

            <!-- System Status -->
            <div class="status-panel">
              <h3>System Status</h3>
              <div class="status-item">
                <span>WebSocket:</span>
                <span id="wsStatus" class="status-badge status-disconnected"
                  >Disconnected</span
                >
                <button id="testWebSocketBtn" class="btn-secondary">
                  Test Connection
                </button>
              </div>
              <div class="status-item">
                <span>Printer:</span>
                <span id="printerStatus" class="status-badge"
                  >Not Selected</span
                >
              </div>
              <div class="status-item">
                <span>Today Orders:</span>
                <span id="todayOrderCount" class="status-badge">0</span>
              </div>
            </div>
          </div>

          <!-- Right Panel -->
          <div class="right-panel">
            <div class="orders-panel">
              <div class="orders-header">
                <h3>Recent Orders</h3>
                <div class="orders-actions">
                  <span id="orderCount" class="order-count">(0)</span>
                  <button id="refreshOrders" class="btn-small">Refresh</button>
                  <button id="clearOrders" class="btn-small btn-danger">
                    Clear
                  </button>
                </div>
              </div>
              <div id="ordersList" class="orders-list">
                <div class="no-orders">No orders yet</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Order Details Modal -->
    <div id="orderModal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Order Details</h3>
          <span class="close">&times;</span>
        </div>
        <div class="modal-body">
          <div id="orderDetails"></div>
        </div>
        <div class="modal-footer">
          <button id="printOrderBtn" class="btn-primary">Print Order</button>
          <button id="closeModalBtn" class="btn-secondary">Close</button>
        </div>
      </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay hidden">
      <div class="loading-spinner">
        <div class="spinner"></div>
        <p>Processing...</p>
      </div>
    </div>

    <script src="js/api.js"></script>
    <script src="js/websocket.js"></script>
    <script src="js/printer.js"></script>
    <script src="js/app.js"></script>
    <script src="test-websocket-auto-print.js"></script>
  </body>
</html>
